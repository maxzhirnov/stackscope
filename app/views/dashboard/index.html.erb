<div class="page">
  <header class="hero hero--compact">
  </header>

  <section class="section">
    <div class="section-header">
      <h2>Shortcuts</h2>
      <div class="section-actions">
        <%= button_to toggle_shortcuts_checks_path, method: :post, class: "icon-button", title: "Toggle checks" do %>
          <%= AppSetting.enabled?("shortcuts_checks_enabled", default: true) ? "⏸" : "▶" %>
        <% end %>
        <%= button_to run_shortcuts_checks_path, method: :post, class: "icon-button", title: "Run checks now" do %>
          ↻
        <% end %>
        <%= link_to "Manage", shortcuts_path, class: "button ghost" %>
      </div>
    </div>

    <div class="shortcut-grid shortcut-grid--icons">
      <% if @shortcuts.any? %>
        <% @shortcuts.each do |shortcut| %>
          <% has_image = shortcut.icon_image.attached? || shortcut.icon_url.present? %>
          <a class="shortcut" href="<%= shortcut.url %>" target="_blank" rel="noreferrer">
            <span class="icon <%= "has-image" if has_image %>"
                  style="background-color: <%= has_image ? "#ffffff" : shortcut.icon_background_color %>;">
              <span class="status-dot <%= shortcut.status_class %>"></span>
              <span class="fallback-letter"><%= shortcut.name.to_s[0]&.upcase %></span>
              <% if shortcut.icon_image.attached? %>
                <%= image_tag shortcut.icon_image, alt: shortcut.name, class: "icon-image" %>
              <% elsif shortcut.icon_url.present? %>
                <%= image_tag shortcut.icon_url, alt: shortcut.name, class: "icon-image" %>
              <% end %>
            </span>
            <div>
              <h3><%= shortcut.name %></h3>
              <p class="muted"><%= shortcut.category %></p>
            </div>
          </a>
        <% end %>
      <% else %>
        <article class="empty-state">
          <h3>No shortcuts yet</h3>
          <p>Add links to open your favorite services in one tap.</p>
        </article>
      <% end %>
      <%= link_to new_shortcut_path(return_to: "dashboard"), class: "shortcut add-card" do %>
        <span class="icon add-icon">+</span>
        <div>
          <h3>Add shortcut</h3>
        </div>
      <% end %>
    </div>
  </section>

  <section class="section">
    <div class="section-header">
      <h2>Servers</h2>
      <div class="section-actions">
        <%= button_to toggle_servers_checks_path, method: :post, class: "icon-button", title: "Toggle checks" do %>
          <%= AppSetting.enabled?("servers_checks_enabled", default: true) ? "⏸" : "▶" %>
        <% end %>
        <%= link_to "Manage", servers_path, class: "button ghost" %>
      </div>
    </div>

    <div class="card-grid">
      <% if @servers.any? %>
        <% @servers.each do |server| %>
          <%= render "dashboard/server_card", server: server %>
        <% end %>
      <% else %>
        <article class="empty-state">
          <h3>No servers yet</h3>
          <p>Add your first node to see status and metrics.</p>
        </article>
      <% end %>
      <%= link_to new_server_path(return_to: "dashboard"), class: "card add-card add-card--server" do %>
        <div class="add-card-content">
          <span class="add-icon">+</span>
          <span>Add server</span>
        </div>
      <% end %>
    </div>
  </section>
</div>
